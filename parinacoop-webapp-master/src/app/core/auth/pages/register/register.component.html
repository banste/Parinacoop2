<main class="flex min-h-screen flex-col items-center justify-start py-12">
  <h1 class="mb-6 text-center text-2xl font-medium text-pretty">
    Nuevo cliente de Parinacoop
  </h1>

  <section class="w-full max-w-3xl space-y-6">
    <!-- Card 1: Información principal -->
    <div class="rounded-xl bg-[#F6F6F6] px-6 py-6 shadow-sm">
      <h2 class="mb-4 text-sm font-medium text-[#333]">Información personal</h2>

      <div class="grid grid-cols-1 gap-4">
        <div class="grid grid-cols-2 gap-4">
          <par-form-field size="large" label="Nombres" [formCtrl]="fc('names')"></par-form-field>
          <par-form-field size="large" label="Primer apellido" [formCtrl]="fc('firstLastName')"></par-form-field>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <par-form-field size="large" label="Segundo apellido" [formCtrl]="fc('secondLastName')"></par-form-field>
          <par-form-field size="large" label="RUN" format="run" [formCtrl]="fc('run')"></par-form-field>
        </div>

        <par-form-field size="large" label="N° de documento" [formCtrl]="fc('documentNumber')"></par-form-field>

        <div class="grid grid-cols-2 gap-4">
          <par-form-field size="large" label="Correo" type="email" [formCtrl]="fc('email')"></par-form-field>
          <par-form-field size="large" label="Teléfono celular" type="tel" [formCtrl]="fc('cellphone')"></par-form-field>
        </div>
      </div>
    </div>

    <!-- Card 2: Dirección (Address fields + Región / Comuna) -->
    <div class="rounded-xl bg-[#F6F6F6] px-6 py-6 shadow-sm">
      <h2 class="mb-4 text-sm font-medium text-[#333]">Dirección</h2>

      <div class="grid grid-cols-1 gap-4">
        <!-- address fields añadidos -->
        <div class="grid grid-cols-2 gap-4">
          <par-form-field size="large" label="Tipo (home/work)" [formCtrl]="fc('typeAddress')"></par-form-field>
          <par-form-field size="large" label="Calle" [formCtrl]="fc('street')"></par-form-field>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <par-form-field size="large" label="Número" type="number" [formCtrl]="fc('number')"></par-form-field>
          <par-form-field size="large" label="Detalle" [formCtrl]="fc('detail')"></par-form-field>
        </div>

        <!-- Region / Commune (existentes) -->
        <mat-form-field appearance="outline" class="w-full" hideRequiredMarker>
          <mat-label>Región</mat-label>
          <mat-select [formControl]="fc('regionId')">
            <mat-option [value]="0">Seleccione una región</mat-option>
            <mat-option *ngFor="let r of (regions$ | async)" [value]="r.id">{{ r.name }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-full" hideRequiredMarker>
          <mat-label>Comuna</mat-label>
          <mat-select [formControl]="fc('communeId')">
            <mat-option [value]="0">Seleccione una comuna</mat-option>
            <mat-option *ngFor="let c of (communes$ | async)" [value]="c.id">{{ c.name }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>

    <!-- Card 3: Contraseña -->
    <div class="rounded-xl bg-[#F6F6F6] px-6 py-6 shadow-sm">
      <h2 class="mb-4 text-sm font-medium text-[#333]">Contraseña</h2>

      <div class="grid grid-cols-1 gap-4">
        <par-form-field size="large" label="Clave" type="password" [formCtrl]="fc('password')"></par-form-field>
        <par-form-field size="large" label="Confirmar clave" type="password" [formCtrl]="fc('confirmPassword')"></par-form-field>

        <label class="mt-2 flex items-start gap-3 text-sm text-[#444]">
          <input type="checkbox" class="mt-1 h-4 w-4 rounded border-gray-300" [formControl]="fc('terms')" />
          <span>Al hacerme cliente de Parinacoop, estoy de acuerdo con ...</span>
        </label>

        <p *ngIf="registerErrorMsg" class="mt-2 rounded-md border border-red-300 bg-red-50 px-4 py-2 text-sm text-red-600">
          {{ registerErrorMsg }}
        </p>

        <button
          type="button"
          (click)="onRegister()"
          [disabled]="registerForm.invalid || isSubmitting"
          [attr.aria-disabled]="registerForm.invalid || isSubmitting"
          [ngClass]="{
            'flex h-10 w-full items-center justify-center rounded-full px-4 text-sm font-medium transition': true,
            'bg-primary-500 text-white hover:bg-primary-600': !(registerForm.invalid || isSubmitting),
            'bg-primary-100 text-primary-600 cursor-not-allowed': registerForm.invalid || isSubmitting
          }"
        >
          <ng-container *ngIf="isSubmitting; else notSubmitting">
            <app-spinner></app-spinner><span class="ml-2">Registrando...</span>
          </ng-container>
          <ng-template #notSubmitting>Registrarse como cliente</ng-template>
        </button>
      </div>
    </div>
  </section>
</main>