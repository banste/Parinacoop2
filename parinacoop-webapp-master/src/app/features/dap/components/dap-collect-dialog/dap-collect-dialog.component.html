<h2 class="title">Por cobrar</h2>

<div class="sub" *ngIf="clientName">
  Cliente: <b>{{ clientName }}</b> (RUN {{ run }})
</div>

<div class="state" *ngIf="loading">Cargando cuenta bancaria...</div>

<div class="error" *ngIf="error">{{ error }}</div>
<div class="success" *ngIf="success">{{ success }}</div>

<div *ngIf="!loading">
  <div class="info" *ngIf="hasAccount">
    Ya tienes una cuenta bancaria registrada.
  </div>

  <div class="form">
    <label>
      RUT titular (con DV)
      <input [(ngModel)]="form.rutOwner" [disabled]="!isEditing" placeholder="20.218.321-2" />
    </label>

    <label>
      Banco (código)
      <input [(ngModel)]="form.bankCode" [disabled]="!isEditing" placeholder="bci / santander / etc." />
    </label>

    <label>
      Banco (nombre)
      <input [(ngModel)]="form.bankName" [disabled]="!isEditing" placeholder="Banco de Chile" />
    </label>

    <label>
      Tipo de cuenta
      <input [(ngModel)]="form.accountType" [disabled]="!isEditing" placeholder="cuenta_corriente / vista / ahorro" />
    </label>

    <label>
      Número de cuenta
      <input [(ngModel)]="form.accountNumber" [disabled]="!isEditing" placeholder="12345678" />
    </label>

    <label>
      Email (opcional)
      <input [(ngModel)]="form.email" [disabled]="!isEditing" placeholder="correo@dominio.cl" />
    </label>
  </div>

  <div class="actions">
    <button type="button" class="btn secondary" (click)="close()">Cerrar</button>

    <button
      *ngIf="hasAccount && !isEditing"
      type="button"
      class="btn secondary"
      (click)="startEdit()"
    >
      Editar
    </button>

    <button
      *ngIf="hasAccount && isEditing"
      type="button"
      class="btn secondary"
      (click)="cancelEdit()"
      [disabled]="saving"
    >
      Cancelar
    </button>

    <button
      *ngIf="isEditing"
      type="button"
      class="btn primary"
      [disabled]="saving"
      (click)="save()"
    >
      {{ saving ? 'Guardando...' : 'Guardar' }}
    </button>

    <button
      *ngIf="hasAccount && !isEditing"
      type="button"
      class="btn charge"
      [disabled]="!canCharge"
      (click)="charge()"
    >
      Cobrar
    </button>
  </div>
</div>