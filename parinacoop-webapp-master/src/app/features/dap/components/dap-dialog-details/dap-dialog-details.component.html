<section style="box-sizing:border-box; max-width:640px; width:100%; margin:0 auto; padding:1.25rem;">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-semibold text-primary-950">
      Detalle del Depósito a Plazo
    </h2>

    <button type="button" mat-button (click)="close()">Cerrar</button>
  </div>

  <!-- Resumen / Estado -->
  <div class="rounded-xl border border-[#dcdcdc] bg-nav-color p-4 mb-5">
    <div class="flex items-center justify-between">
      <div>
        <div class="text-sm text-primary-700">Depósito a Plazo</div>
        <div class="text-lg font-semibold text-primary-950">
          {{ currentDap ? (currentDap.id | idPad) : '-' }}
        </div>
      </div>

      <div class="text-right">
        <div class="text-sm text-primary-700">Estado</div>
        <div
          class="text-sm font-semibold"
          [ngClass]="{
            'text-green-700': currentDap.status === DapStatus.ACTIVE || currentDap.status === DapStatus.PAID,
            'text-orange-700': currentDap.status === DapStatus.PENDING || currentDap.status === DapStatus.EXPIRED_PENDING,
            'text-red-700': currentDap.status === DapStatus.EXPIRED
          }"
        >
          {{ currentDap.status | dapStatus }}
        </div>
      </div>
    </div>
  </div>

  <!-- Datos principales -->
  <div class="rounded-lg border p-4 bg-white mb-4">
    <div class="mb-3 text-sm font-medium">Datos del depósito</div>
    <div class="grid grid-cols-2 gap-x-6 gap-y-2 items-start">
      <div class="text-sm text-primary-700">Tipo</div>
      <div class="text-sm text-primary-900">{{ currentDap.type | dapType }}</div>

      <div class="text-sm text-primary-700">Moneda</div>
      <div class="text-sm text-primary-900">{{ currentDap.currencyType ?? '-' }}</div>

      <div class="text-sm text-primary-700">Plazo (días)</div>
      <div class="text-sm text-primary-900">{{ currentDap && currentDap.days != null ? currentDap.days.toString() : '-' }}</div>

      <div class="text-sm text-primary-700">Fecha ingreso</div>
      <div class="text-sm text-primary-900">{{ currentDap && currentDap.initialDate ? (currentDap.initialDate | date:'dd-MM-yyyy') : '-' }}</div>

      <div class="text-sm text-primary-700">Vencimiento</div>
      <div class="text-sm text-primary-900">{{ currentDap && currentDap.dueDate ? (currentDap.dueDate | date:'dd-MM-yyyy') : '-' }}</div>

      <div class="text-sm text-primary-700">Monto capital</div>
      <div class="text-sm text-primary-900">{{ currentDap && currentDap.initialAmount != null ? (currentDap.initialAmount | currency:'CLP':'symbol':'1.0-0') : '-' }}</div>

      <div class="text-sm text-primary-700">Monto a recibir</div>
      <div class="text-sm text-primary-900">{{ currentDap && currentDap.finalAmount != null ? (currentDap.finalAmount | currency:'CLP':'symbol':'1.0-0') : '-' }}</div>

      <div class="text-sm text-primary-700">Intereses</div>
      <div class="text-sm text-primary-900">
        {{ displayInterest != null ? (displayInterest | percent:'1.2-2') : '-' }}
      </div>

      <!-- Nueva fila: ID interna (solo si existe) -->
      <div class="text-sm text-primary-700">ID interna</div>
      <div class="text-sm text-primary-900">{{ currentDap.internalId ?? '-' }}</div>
    </div>
  </div>

  <!-- Acciones: descargar solicitud / instructivo (ocultas a admin) -->
  <div class="flex gap-2 justify-end">
    <button
      *ngIf="!isAdmin"
      mat-stroked-button
      color="primary"
      (click)="descargarSolicitudPdf()"
      [disabled]="isDownloadingSolicitud"
    >
      Descargar solicitud
    </button>

    <button
      *ngIf="!isAdmin"
      mat-stroked-button
      color="primary"
      (click)="descargarInstructivoPdf()"
      [disabled]="isDownloadingInstructivo"
    >
      Descargar instructivo
    </button>
  </div>
</section>