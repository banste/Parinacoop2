<section class="p-6 min-w-[22rem]">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-semibold text-primary-950">
      Detalle del Depósito a Plazo
    </h2>

    <button type="button" mat-button (click)="close()">Cerrar</button>
  </div>

  <!-- Resumen / Estado -->
  <div class="rounded-xl border border-[#dcdcdc] bg-nav-color p-4 mb-5">
    <div class="flex items-center justify-between">
      <div>
        <div class="text-sm text-primary-700">Depósito a Plazo</div>
        <div class="text-lg font-semibold text-primary-950">
          {{ currentDap ? (currentDap.id | idPad) : '-' }}
        </div>
      </div>

      <div class="text-right">
        <div class="text-sm text-primary-700">Estado</div>

        <div
          class="font-semibold"
          [ngClass]="{
            'text-green-700':
              currentDap?.status === DapStatus.ACTIVE ||
              currentDap?.status === DapStatus.PAID,
            'text-orange-700':
              currentDap?.status === DapStatus.PENDING ||
              currentDap?.status === DapStatus.EXPIRED_PENDING,
            'text-red-700': currentDap?.status === DapStatus.EXPIRED
          }"
        >
          {{ currentDap ? (currentDap.status | dapStatus) : '-' }}
        </div>
      </div>
    </div>
  </div>

  <!-- Detalles -->
  <div class="rounded-xl border border-[#dcdcdc] p-4 mb-5">
    <h3 class="font-semibold text-primary-950 mb-2">Datos del depósito</h3>

    <dap-detail label="Tipo" [value]="currentDap ? (currentDap.type | dapType) : '-'"></dap-detail>

    <dap-detail label="Moneda" [value]="currentDap?.currencyType ?? '-'"></dap-detail>

    <dap-detail
      label="Plazo (días)"
      [value]="currentDap && currentDap.days != null ? currentDap.days.toString() : '-'"
    ></dap-detail>

    <dap-detail
      label="Fecha ingreso"
      [value]="currentDap && currentDap.initialDate ? (currentDap.initialDate | date:'dd-MM-yyyy') : '-'"
    ></dap-detail>

    <dap-detail
      label="Vencimiento"
      [value]="currentDap && currentDap.dueDate ? (currentDap.dueDate | date:'dd-MM-yyyy') : '-'"
    ></dap-detail>

    <dap-detail
      label="Monto capital"
      [value]="currentDap && currentDap.initialAmount != null ? (currentDap.initialAmount | currency:'CLP':'symbol':'1.0-0') : '-'"
    ></dap-detail>

    <dap-detail
      label="Monto a recibir"
      [value]="currentDap && currentDap.finalAmount != null ? (currentDap.finalAmount | currency:'CLP':'symbol':'1.0-0') : '-'"
    ></dap-detail>

    <dap-detail
      label="Intereses"
      [value]="currentDap && currentDap.profit != null ? (currentDap.profit | currency:'CLP':'symbol':'1.0-0') : '-'"
    ></dap-detail>

    <dap-detail
      label="Tasa mensual"
      [value]="currentDap && currentDap.interestRateInMonth != null ? (currentDap.interestRateInMonth | percent:'1.2-2') : '-'"
    ></dap-detail>

    <dap-detail
      label="Tasa período"
      [value]="currentDap && currentDap.interestRateInPeriod != null ? (currentDap.interestRateInPeriod | percent:'1.2-2') : '-'"
    ></dap-detail>
  </div>

  <!-- Documentos -->
  <div class="rounded-xl border border-[#dcdcdc] bg-nav-color p-4">
    <h3 class="font-semibold text-primary-950 mb-2">Documentos del depósito</h3>

    <div class="flex flex-wrap gap-3">
      <button
        type="button"
        mat-raised-button
        color="primary"
        (click)="descargarSolicitudPdf()"
        [disabled]="isDownloadingSolicitud"
      >
        <mat-icon>download</mat-icon>
        <span class="ml-2">
          {{ isDownloadingSolicitud ? 'Descargando...' : 'Descargar Solicitud (PDF)' }}
        </span>
      </button>

      <button
        type="button"
        mat-stroked-button
        color="primary"
        (click)="descargarInstructivoPdf()"
        [disabled]="isDownloadingInstructivo"
      >
        <mat-icon>download</mat-icon>
        <span class="ml-2">
          {{ isDownloadingInstructivo ? 'Descargando...' : 'Descargar Instructivo (PDF)' }}
        </span>
      </button>
    </div>

    <p class="mt-3 text-sm text-primary-700">
      Descarga la solicitud, fírmala y sigue el instructivo para realizar el depósito en la cuenta correspondiente.
    </p>
  </div>
</section>