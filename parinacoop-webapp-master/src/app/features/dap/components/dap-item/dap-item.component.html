<article class="dap-item-article" role="row" aria-label="Fila depósito" [attr.data-id]="dap?.id">
  <!-- 1: Depósito (ID) -->
  <div class="cell cell-id">N° {{ formatId(dap?.id) }}</div>

  <!-- 2: Número de operación -->
  <div class="cell cell-op">
    <span class="op-value">{{ dap?.internalId ?? '-' }}</span>
  </div>

  <!-- 3: Fecha inversión -->
  <div class="cell cell-date">{{ formatInvestmentDate(dap) }}</div>

  <!-- 4: Vencimiento -->
  <div class="cell cell-due">{{ dap?.dueDate ? (dap.dueDate | date: 'dd-MM-yyyy') : '-' }}</div>

  <!-- 5: Monto a recibir -->
  <div class="cell cell-amount">
    {{ dap?.finalAmount != null ? (dap.finalAmount | currency: 'CLP':'symbol':'1.0-0') : '-' }}
  </div>

  <!-- 6: Interés (lo que va a ganar) -->
  <div class="cell cell-interest">
    <ng-container *ngIf="getInterestAmount(dap) !== null; else noInterest">
      {{ getInterestAmount(dap) | currency: 'CLP':'symbol':'1.0-0' }}
    </ng-container>
    <ng-template #noInterest>-</ng-template>
  </div>

  <!-- 7: Estado (label + círculo de color) -->
  <div class="cell cell-status">
    <span class="status-item" role="status" aria-label="Estado del depósito">
      <span class="status-dot" [ngClass]="statusDotClass(dap?.status)" aria-hidden="true"></span>
      <span class="status-label">{{ statusLabel(dap?.status) }}</span>
    </span>
  </div>

  <!-- 8: Acciones -->
  <div class="cell cell-actions">
    <div class="actions-inner">
      <!-- NUEVO: Por cobrar (botón circular como los otros) -->
      <button
  *ngIf="canCollect(dap)"
  type="button"
  class="action-btn collect-btn"
  (click)="onCollectClick()"
  aria-label="Por cobrar"
  title="Por cobrar"
>
  <span class="collect-dollar" aria-hidden="true">$</span>
</button>

      <button type="button" class="action-btn detail-btn" (click)="onViewDetailClick()" aria-label="Ver detalle" title="Ver detalle">
        <svg class="icon" viewBox="0 0 512 512" width="20" height="20" fill="currentColor" aria-hidden="true">
          <path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>
        </svg>
      </button>

      <button type="button" class="action-btn attach-btn" (click)="onViewAttachmentsClick()" aria-label="Adjuntos" title="Adjuntos">
        <svg class="icon" viewBox="0 0 576 512" width="20" height="20" fill="currentColor" aria-hidden="true">
          <path d="M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z"/>
        </svg>
      </button>
    </div>
  </div>
</article>